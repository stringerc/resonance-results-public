<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resonance Calculus Results | Real-Time Performance Metrics</title>
    <meta name="description" content="Real-time Resonance Calculus performance metrics, component breakdown, and validation results">
    
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">Resonance Calculus</h1>
                <p class="subtitle">Real-Time Performance Metrics & Validation Results</p>
            </div>
            <div class="header-meta">
                <span class="last-updated">Last Updated: <span id="lastUpdated">Loading...</span></span>
                <span class="status-badge" id="statusBadge">‚óè Live</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Executive Summary -->
        <section class="summary-section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card primary">
                    <div class="card-label">Global Resonance R(t)</div>
                    <div class="card-value" id="globalR">-</div>
                    <div class="card-status" id="rStatus">-</div>
                    <div class="card-band">
                        <div class="band-indicator" id="bandIndicator"></div>
                        <span class="band-label">Target: [0.35, 0.65]</span>
                    </div>
                </div>
                
                <div class="summary-card">
                    <div class="card-label">Band Compliance</div>
                    <div class="card-value" id="bandCompliance">-</div>
                    <div class="card-subvalue" id="bandComplianceNote">Target: ‚â•85%</div>
                </div>
                
                <div class="summary-card">
                    <div class="card-label">P99 Latency Improvement</div>
                    <div class="card-value" id="p99Improvement">-</div>
                    <div class="card-subvalue">vs Baseline</div>
                </div>
                
                <div class="summary-card">
                    <div class="card-label">Validation Status</div>
                    <div class="card-value" id="validationStatus">-</div>
                    <div class="card-subvalue" id="validationDetails">-</div>
                </div>
            </div>
        </section>

        <section class="summary-section">
            <h2>Tuning Checklist</h2>
            <div class="summary-card" style="max-width:720px">
                <p class="card-label" style="margin-bottom:12px">Band compliance improves only when the agent runs in adaptive control and receives live phase samples.</p>
                <ol class="card-subvalue" style="color:#1f2937; line-height:1.6">
                    <li><strong>Run the agent in adaptive mode</strong> ‚Äî set <code>RESONANCE_MODE=adaptive</code> (Render ‚Üí Environment) and redeploy.</li>
                    <li><strong>Feed phase / latency samples</strong> ‚Äî install the Resonance SDK in your service or run <code>node resonance/bench/feed_phases.js</code> to POST samples to the intake endpoint.</li>
                    <li><strong>Give it a few minutes</strong> ‚Äî once ~50 samples arrive, Resonance Calculus metrics populate and R(t) begins climbing into the optimal band.</li>
                    <li><strong>Tune if needed</strong> ‚Äî adjust coupling (K_min/K_max) or workload mix if R(t) remains outside the band after several minutes.</li>
                </ol>
                <p class="card-subvalue" style="margin-top:12px">Need help? Click the Intercom assistant (when enabled) for a guided walkthrough.</p>
            </div>
        </section>

        <!-- Resonance Components Breakdown -->
        <section class="components-section">
            <h2>Resonance Components</h2>
            <div class="components-grid">
                <div class="component-card coherence">
                    <div class="component-header">
                        <h3>Coherence Score</h3>
                        <span class="component-icon">üìä</span>
                    </div>
                    <div class="component-value" id="coherenceScore">-</div>
                    <div class="component-bar">
                        <div class="component-progress" id="coherenceBar" style="width: 0%"></div>
                    </div>
                    <div class="component-description">
                        Coherence-Weighted Service Curve (CWSC)
                    </div>
                </div>
                
                <div class="component-card tail">
                    <div class="component-header">
                        <h3>Tail Health Score</h3>
                        <span class="component-icon">üìà</span>
                    </div>
                    <div class="component-value" id="tailHealthScore">-</div>
                    <div class="component-bar">
                        <div class="component-progress" id="tailBar" style="width: 0%"></div>
                    </div>
                    <div class="component-description">
                        Extreme Value Theory (EVT/GPD)
                    </div>
                </div>
                
                <div class="component-card timing">
                    <div class="component-header">
                        <h3>Timing Score</h3>
                        <span class="component-icon">‚è±Ô∏è</span>
                    </div>
                    <div class="component-value" id="timingScore">-</div>
                    <div class="component-bar">
                        <div class="component-progress" id="timingBar" style="width: 0%"></div>
                    </div>
                    <div class="component-description">
                        Max-Plus Algebra (Cycle Time)
                    </div>
                </div>
                
                <div class="component-card lambda">
                    <div class="component-header">
                        <h3>Max-Plus Œª_res</h3>
                        <span class="component-icon">üîó</span>
                    </div>
                    <div class="component-value" id="lambdaRes">-</div>
                    <div class="component-description">
                        Maximum Cycle Mean
                    </div>
                </div>
            </div>
        </section>

        <!-- Global Resonance R(t) Chart -->
        <section class="chart-section">
            <h2>Global Resonance R(t) Over Time</h2>
            <div class="chart-container">
                <canvas id="rChart"></canvas>
            </div>
            <div class="chart-controls">
                <button class="time-range-btn active" data-range="1h">Last Hour</button>
                <button class="time-range-btn" data-range="24h">Last 24 Hours</button>
                <button class="time-range-btn" data-range="7d">Last 7 Days</button>
                <button class="time-range-btn" data-range="30d">Last 30 Days</button>
            </div>
            <p id="timeRangeStatus" class="text-sm text-gray-500 text-center mt-2 hidden"></p>
            <div class="chart-explainer">
                <p>
                    <strong>How to read this:</strong> Every dot represents one sample from the Resonance agent.
                    A single synthetic feed keeps R(t) around 0.18, which is expected; real production traffic
                    or multiple simulated streams will nudge the trace into the green optimal band (0.35 &ndash; 0.65).
                    Leave this page open to accumulate history, or rerun the phase feeder to refresh the graph.
                </p>
            </div>
        </section>

        <!-- Component Breakdown Chart -->
        <section class="chart-section">
            <h2>Component Breakdown</h2>
            <div class="chart-container">
                <canvas id="componentsChart"></canvas>
            </div>
        </section>

        <!-- Tail Health Analysis -->
        <section class="tail-section">
            <h2>Tail Health Analysis</h2>
            <div class="tail-grid">
                <div class="tail-card">
                    <h3>GPD Parameters</h3>
                    <div class="tail-params">
                        <div class="param-item">
                            <span class="param-label">Shape (Œæ):</span>
                            <span class="param-value" id="gpdXi">-</span>
                        </div>
                        <div class="param-item">
                            <span class="param-label">Scale (œÉ):</span>
                            <span class="param-value" id="gpdSigma">-</span>
                        </div>
                        <div class="param-item">
                            <span class="param-label">Threshold (u):</span>
                            <span class="param-value" id="gpdThreshold">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="tail-card">
                    <h3>Tail Quantiles</h3>
                    <div class="tail-quantiles">
                        <div class="quantile-item">
                            <span class="quantile-label">Q99:</span>
                            <span class="quantile-value" id="tailQ99">-</span>
                            <span class="quantile-unit">ms</span>
                        </div>
                        <div class="quantile-item">
                            <span class="quantile-label">Q99.9:</span>
                            <span class="quantile-value" id="tailQ99_9">-</span>
                            <span class="quantile-unit">ms</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Performance Metrics -->
        <section class="metrics-section">
            <h2>Performance Metrics</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-label">P50 Latency</div>
                    <div class="metric-value" id="p50Latency">-</div>
                    <div class="metric-unit">ms</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">P95 Latency</div>
                    <div class="metric-value" id="p95Latency">-</div>
                    <div class="metric-unit">ms</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">P99 Latency</div>
                    <div class="metric-value" id="p99Latency">-</div>
                    <div class="metric-unit">ms</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">P99.9 Latency</div>
                    <div class="metric-value" id="p99_9Latency">-</div>
                    <div class="metric-unit">ms</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Spectral Entropy</div>
                    <div class="metric-value" id="spectralEntropy">-</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Coupling K(t)</div>
                    <div class="metric-value" id="couplingK">-</div>
                </div>
            </div>
        </section>

        <!-- Validation Results -->
        <section class="validation-section">
            <h2>Validation Results</h2>
            <div class="validation-grid">
                <div class="validation-card">
                    <h3>Test Coverage</h3>
                    <div class="validation-stats">
                        <div class="stat-item">
                            <span class="stat-label">Tests Passed:</span>
                            <span class="stat-value" id="testsPassed">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Tests:</span>
                            <span class="stat-value" id="totalTests">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Coverage:</span>
                            <span class="stat-value" id="testCoverage">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="validation-card">
                    <h3>System Health</h3>
                    <div class="health-indicators">
                        <div class="health-item">
                            <span class="health-label">Agent Status:</span>
                            <span class="health-value" id="agentStatus">-</span>
                        </div>
                        <div class="health-item">
                            <span class="health-label">Metrics Collection:</span>
                            <span class="health-value" id="metricsStatus">-</span>
                        </div>
                        <div class="health-item">
                            <span class="health-label">Data Quality:</span>
                            <span class="health-value" id="dataQuality">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>Resonance Calculus Results | <a href="https://resonance.syncscript.app">Main Dashboard</a></p>
            <p class="footer-meta">Data updates every 5 seconds | Last validation: <span id="lastValidation">-</span></p>
        </footer>
    </main>

    <script src="assets/js/metrics.js"></script>
    <script src="assets/js/charts.js"></script>
    <script>
        (function(){
            var appId = window.INTERCOM_APP_ID || 'YOUR_INTERCOM_APP_ID';
            if(!appId || appId === 'YOUR_INTERCOM_APP_ID') return;
            window.intercomSettings = { app_id: appId };
            var w = window; var ic = w.Intercom;
            if(typeof ic === "function"){
                ic('reattach_activator');
                ic('update', window.intercomSettings);
            } else {
                var d = document; var i = function(){ i.c(arguments); };
                i.q = []; i.c = function(args){ i.q.push(args); };
                w.Intercom = i;
                function l(){
                    var s = d.createElement('script'); s.type = 'text/javascript'; s.async = true;
                    s.src = 'https://widget.intercom.io/widget/' + appId;
                    var x = d.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
                }
                if(document.readyState === 'complete') {
                    l();
                } else if(w.attachEvent) {
                    w.attachEvent('onload', l);
                } else {
                    w.addEventListener('load', l, false);
                }
            }
        })();
    </script>
</body>
</html>

